<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Garaj Yönetimi | TamŞarj</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;900&display=swap" rel="stylesheet">
<style>
body { background: #cfd8dc; font-family: 'Montserrat', sans-serif; padding: 40px; }
.glass-card { max-width: 800px; margin: auto; background: #fff; border-radius: 30px; padding: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); }
.car-list { max-height: 150px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 10px; margin-bottom: 20px; }
.car-item { padding: 10px 20px; cursor: pointer; border-bottom: 1px solid #eee; transition: 0.2s; }
.car-item:hover { background: #f8f9fa; }
.car-item.active { background: #2ecc71; color: white; font-weight: bold; }
.garage-list { margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px; }
</style>
</head>
<body>
<div class="glass-card">
<h2 class="fw-bold text-center mb-4">GARAJA ARAÇ EKLE/GÜNCELLE</h2>
<input type="hidden" id="editId">
<input type="text" id="ad" class="form-control mb-3 p-3" placeholder="Adınız Soyadınız">
<input type="text" id="plaka" class="form-control mb-3 p-3" placeholder="Plaka (Örn: 34 EV 2026)">
<label class="fw-bold mb-2">Model Seçiniz:</label>
<div class="car-list" id="carList"></div>
<label class="fw-bold mb-2">Model Yılı:</label>
<select id="yil" class="form-select mb-4 p-3"></select>
<div class="d-flex gap-2">
<button id="btnKaydet" onclick="kaydet()" class="btn btn-dark w-100 py-3 rounded-pill fw-bold">KAYDET</button>
<button id="btnGuncelle" onclick="guncelle()" class="btn btn-success w-100 py-3 rounded-pill fw-bold d-none">GÜNCELLE</button>
</div>
<div class="garage-list">
<h4 class="fw-bold mb-3">Kayıtlı Araçlarım</h4>
<div id="garageContainer" class="list-group"></div>
</div>
</div>
<script>
const cars = ["Tesla Model Y", "Togg T10X", "Porsche Taycan", "Hyundai IONIQ 5", "BMW i4", "Mercedes EQS", "Audi Q4 e-tron", "Kia EV6", "Volvo XC40 Recharge", "Renault Zoe", "Skywell ET5", "MG4 Electric", "Fiat 500e"];
let selectedCar = null;
const listDiv = document.getElementById('carList');
cars.forEach(car => {
const d = document.createElement('div');
d.className = 'car-item';
d.innerText = car;
d.onclick = () => {
selectedCar = car;
document.querySelectorAll('.car-item').forEach(x => x.classList.remove('active'));
d.classList.add('active');
};
listDiv.appendChild(d);
});
const yearSelect = document.getElementById('yil');
for(let i = 2026; i >= 2010; i--) {
yearSelect.innerHTML += `<option value="${i}">${i}</option>`;
}
function kaydet() {
const ad = document.getElementById('ad').value;
const plaka = document.getElementById('plaka').value;
const yil = document.getElementById('yil').value;
if(!ad || !selectedCar || !plaka) return alert("Hata!");
fetch('/api/kaydet', {
method: 'POST',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify({ ad, arac: selectedCar, plaka, yil })
}).then(() => location.reload());
}
function sil(id) {
if(confirm("Silinsin mi?")) {
fetch(`/api/sil/${id}`, { method: 'DELETE' }).then(() => location.reload());
}
}
function duzenleModu(id, ad, plaka, arac, yil) {
document.getElementById('editId').value = id;
document.getElementById('ad').value = ad;
document.getElementById('plaka').value = plaka;
document.getElementById('yil').value = yil;
selectedCar = arac;
document.querySelectorAll('.car-item').forEach(i => {
if(i.innerText === arac) i.classList.add('active');
else i.classList.remove('active');
});
document.getElementById('btnKaydet').classList.add('d-none');
document.getElementById('btnGuncelle').classList.remove('d-none');
}
function guncelle() {
const id = document.getElementById('editId').value;
const data = { ad: document.getElementById('ad').value, plaka: document.getElementById('plaka').value, arac: selectedCar, yil: document.getElementById('yil').value };
fetch(`/api/guncelle/${id}`, {
method: 'PUT',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify(data)
}).then(() => location.reload());
}
</script>
</body>
</html>